* Table of Contents :TOC_3:
  - [[#introduction][Introduction]]
  - [[#demos][Demos]]
  - [[#installation][Installation]]
  - [[#dependency][Dependency]]
  - [[#usage][Usage]]
  - [[#changelog][ChangeLog]]
  - [[#todo][Todo]]
  - [[#acknowledgements][Acknowledgements]]

** Introduction
   Gk-roam is a light-weight roam replica, built on top of emacs org-mode. It uses 'ripgrep' to search pages' links and insert references at the bottom of org pages automatically. Almostly, gk-roam imitates roam research in many aspects. More useful functionality will be implemented in future.

** Demos

   [[./demos/completion.gif]]

   [[./demos/brackets.gif]]

** Installation
   
   Clone this repo and add gk-roam to your emacs load-path. My configurations are as follows. Free feel to modify them as you like.

   #+BEGIN_SRC emacs-lisp
   (use-package gk-roam
     :load-path "~/iCloud/hack/gk-roam/"
     :init
     (setq gk-roam-root-dir "~/gk-roam/org/"
	   gk-roam-pub-dir "~/gk-roam/site/")
     :bind
     (("C-c r G" . gk-roam-update-all)
      ("C-c r g" . gk-roam-update)
      ("C-c r d" . gk-roam-daily)
      ("C-c r f" . gk-roam-find)
      ("C-c r n" . gk-roam-smart-new)
      ("C-c r i" . gk-roam-insert)
      ("C-c r I" . gk-roam-index)
      ("C-c r p" . gk-roam-preview)
      ("C-c r v" . gk-roam-preview-current)
      ("C-c r t" . gk-roam-toggle-brackets)))
   #+END_SRC

** Dependency

   * [[https://github.com/skeeto/emacs-web-server][simple-httpd.el]] is used for html preview, install it in emacs.
   * [[https://github.com/tarsiiformes/undo-tree][undo-tree.el]] is used to restore gk-roam formatted link after publishing.
   * ripgrep(rg) is used for search reference link, install it through os package manager and ensure that the command =rg= is in /exec-path/ variable.

** Usage

   *Shortcut keys:*

   | shortcut | function                      |
   |----------+-------------------------------|
   | ={[]}=   | complete page link at point   |
   | =#=      | complete hashtag at point     |
   
   *Main functions:*

   =gk-roam-find=\\
   Find a gk-roam file and open it. If not exisit, create a new one. Just like /ido-find-file/.

   =gk-roam-daily=\\
   Create or open 'daily notes' page.

   =gk-roam-toggle-brackets=\\
   Hide and show brackets of link and hashtag.

   =gk-roam-insert=\\
   Insert a page bracket link at point.

   =gk-roam-smart-new=\\
   Smartly create a new file. If in a region, read the text in region as file title. if a word at point, read the text at point as file title. Otherwise, use =gk-roam-find=. At last, insert a file link at point or in region.

   =gk-roam-index=\\
   Show gk-roam index page. Well, it's just a simple site map because I have not get good ideas about it. Feel free to give me an issue or PR.

   =gk-roam-update=\\
   Update current buffer's references. Actually, references are updated automatically.

   =gk-roam-update-all=\\
   Update all files' references.

   =gk-roam-publish-current-file=\\
   Publish current file to html.

   =gk-roam-preview-current=\\
   Preview current file in browser.

   =gk-roam-publish-site=\\
   Publish the whole gk-roam site.

   =gk-roam-preview=\\
   Preview gk-roam site's index page.

** ChangeLog
   - =v1.0=: Auto update link references at the bottom of page buffer.
   - =v2.0=: Use overlay to hide and show gk-roam brackets accordingly and fix some bugs.
   - =v2.0.1=: Fix 'hide and show brackets' problems in some main occasion. Such as newline, etc.
   - =v2.0.2=: Fix =gk-roam-publish-current-file=, automatically convert gk-roam link to org link and convert it back after published (use 'undo', not reliable) . But it has problem with publishing the whole project.
   - =v2.0.3=: Fix =gk-roam-publish-site= and =gk-roam-preview=. Now you can publish and preview the whole roam site.
   - =v2.0.4=: Many bugs fixed and code improvement.
   - =v2.1.0=: A more powerful linked references system.

** Todo
   
   Recently, I have been watching [[https://www.youtube.com/playlist?list=PLwXSqDdn_CpE934BjXMgmzHnlwXMy41TC][videos]] about Roam Research. From it, I have got lots of ideas to improve gk-roam. The ideas are as follows:

   * [X] Simply insert linked references at the bottom of page.
   * [X] Add "gk-roam-daily" function to open a 'daily notes' page.
   * [X] Custom link notation: "{[page-title]}" for page link, "#{[page-title]}" for hashtag.
   * [X] Do auto completion after input brackets and hash symbol.
   * [X] Automatically hide and show brackets when move to a line including gk-roam links.
   * [X] Convert gk-roam link to org file link before publish and convert back when published.
   * [X] A more reasonable linked references form.
   * [ ] Implement 'block reference' and 'block embeds'.

   More in future!

** Acknowledgements

   Thanks to cool guys in [[https://emacs-china.org][emacs-china.org]] who answered some key questions. Specially thanks to [[https://github.com/casouri][casouri]], his [[https://github.com/casouri/lunarymacs/blob/master/site-lisp/bklink.el][bklink.el]] gives me lots of ideas.
